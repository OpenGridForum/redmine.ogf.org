<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

This is a static archive of the previous Open Grid Forum Redmine content management system saved from host redmine.ogf.org file /issues/316 at Thu, 03 Nov 2022 01:52:45 GMT
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>document #316: Action 242 part 1 - valueLength and contentLength clarifications - DFDL WG - Open Grid Forum</title>
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token"/>
<meta name="csrf-token" content="r8Eug2mxB/WVzjgYLFlaVTYqdY6Jf1KWLwk+E/4zIM4="/>
<link rel='shortcut icon' href='../favicon4460.ico?1425381960' />
<link href="../themes/ogf_redmine/stylesheets/application4460.css?1425381960" media="all" rel="stylesheet" type="text/css" />

<script src="../javascripts/prototype4460.js?1425381960" type="text/javascript"></script>
<script src="../javascripts/effects4460.js?1425381960" type="text/javascript"></script>
<script src="../javascripts/dragdrop4460.js?1425381960" type="text/javascript"></script>
<script src="../javascripts/controls4460.js?1425381960" type="text/javascript"></script>
<script src="../javascripts/application4460.js?1425381960" type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
Event.observe(window, 'load', function(){ new WarnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>

<!--[if IE 6]>
    <style type="text/css">
      * html body{ width: expression( document.documentElement.clientWidth < 900 ? '900px' : '100%' ); }
      body {behavior: url(/stylesheets/csshover.htc?1425381960);}
    </style>
<![endif]-->
<link href="../plugin_assets/extended_fields/stylesheets/extended_fields4460.css?1425381960" media="screen" rel="stylesheet" type="text/css" /> <link href="../plugin_assets/wiking/stylesheets/wiking4460.css?1425381960" media="screen" rel="stylesheet" type="text/css" />
<!-- page specific tags -->

    <link href="https://redmine.ogf.org/issues/316.atom" rel="alternate" title="DFDL WG - document #316: Action 242 part 1 - valueLength and contentLength clarifications" type="application/atom+xml" />
    <link href="../stylesheets/scm4460.css?1425381960" media="screen" rel="stylesheet" type="text/css" />
    <script src="../javascripts/context_menu4460.js?1425381960" type="text/javascript"></script>
    <link href="../stylesheets/context_menu4460.css?1425381960" media="screen" rel="stylesheet" type="text/css" />
    
</head>
<body class="theme-Ogf redmine controller-issues action-show">
<div id="wrapper">
<div id="wrapper2">
<div id="top-menu">
    <div id="account">
        <ul><li><a href="https://redmine.ogf.org/login" class="login">Login</a></li>
<li><a href="../account/register.html" class="register">Register</a></li></ul>    </div>
    
    <ul><li><a href="../index.html" class="home">Home</a></li>
<li><a href="../projects.html" class="projects">Projects</a></li>
<li><a href="http://www.redmine.org/guide" class="help">Help</a></li></ul></div>

<div id="header">
    
    <div id="quick-search">
        <form action="https://redmine.ogf.org/search/index/dfdl-wg" method="get">
        <input name="issues" type="hidden" value="1" />
        <label for='q'>
          <a href="../search/index/dfdl-wg.html" accesskey="4">Search</a>:
        </label>
        <input accesskey="f" class="small" id="q" name="q" size="20" type="text" />
        </form>
        
    </div>
    

    <h1><a href="../projects/standards/issues.html?jump=issues" class="root">Standards</a> » <a href="../projects/data-area/issues.html?jump=issues" class="ancestor">Data Area</a> » DFDL WG</h1>

    
    <div id="main-menu">
        <ul><li><a href="../projects/dfdl-wg.html" class="overview">Overview</a></li>
<li><a href="../tab/show/dfdl-wg.html" class="tab">Project Info</a></li>
<li><a href="../projects/dfdl-wg/roadmap.html" class="roadmap">Roadmap</a></li>
<li><a href="../projects/dfdl-wg/issues.html" class="issues selected">Issues</a></li>
<li><a href="../projects/dfdl-wg/issues/calendar.html" class="calendar">Calendar</a></li>
<li><a href="../projects/dfdl-wg/news.html" class="news">News</a></li>
<li><a href="../dmsf/dfdl-wg.html" class="dmsf">Documents</a></li>
<li><a href="../projects/dfdl-wg/wiki.html" class="wiki">Wiki</a></li>
<li><a href="../projects/dfdl-wg/files.html" class="files">Files</a></li>
<li><a href="../projects/dfdl-wg/repository.html" class="repository">Repository</a></li>
<li><a href="../projects/dfdl-wg/embedded/index.html" class="embedded">Mailing Lists</a></li></ul>
    </div>
    
</div>

<div class="" id="main">
    <div id="sidebar">
        
  <h3>Issues</h3>
<a href="https://redmine.ogf.org/projects/dfdl-wg/issues?set_filter=1">View all issues</a><br />

<a href="../projects/dfdl-wg/issues/report.html">Summary</a><br />


  
  




  <a href="../projects/dfdl-wg/issues/calendar.html">Calendar</a><br />




<h3>Custom queries</h3><a href="../projects/dfdl-wg/issues1f97.html?query_id=3">open grouped by target version sorted by last updated</a>



  

        
  
  


    </div>

    <div id="content">
        
        <div class="contextual">


<span class="issue-316-watcher"></span>




</div>


<h2>document #316</h2>

<div class="issue status-16 priority-2 closed details">
        

<div class="subject">
<div><h3>Action 242 part 1 - valueLength and contentLength clarifications</h3></div>
</div>
        <p class="author">
        Added by <a href="../users/91.html">Michael Beckerle</a> <a href="https://redmine.ogf.org/projects/dfdl-wg/activity?from=2016-08-02" title="08/02/2016 12:48 PM">over 6 years</a> ago.
        
        Updated <a href="https://redmine.ogf.org/projects/dfdl-wg/activity?from=2020-10-29" title="10/29/2020 01:28 PM">about 2 years</a> ago.
        
        </p>

<table class="attributes">
<tr>
    <th class="status">Status:</th><td class="status">closed</td>
    <th class="start-date">Start date:</th><td class="start-date">08/02/2016</td>
</tr>
<tr>
    <th class="priority">Priority:</th><td class="priority">Normal</td>
    <th class="due-date">Due date:</th><td class="due-date"></td>
</tr>
<tr>
    <th class="assigned-to">Assignee:</th><td class="assigned-to">-</td>
    <th class="progress">% Done:</th><td class="progress"><table class="progress" style="width: 80px;"><tr><td class="closed" style="width: 100%;"></td></tr></table><p class="pourcent">100%</p></td>
</tr>
<tr>
    <th class="category">Category:</th><td class="category">-</td>
    
</tr>
<tr>
    <th class="fixed-version">Target version:</th><td class="fixed-version"><a href="../versions/2.html">DFDL v1.0</a></td>
    
</tr>
<tr>
	<th>Document Type:</th><td>Proposed Recommendation</td>
</tr>


</table>

<hr />

  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>(From the email thread in discussion of Action 242. There are 3 separate issue trackers associated with Action 242's resolution. This is the first one.)</p>


	<p>1) we need the concept of valueLength of a complexType which excludes the ElementUnused region, so that contentLength of a complexType can include the ElementUnused region.</p>


	<p>The example that motivates this is from PCAP where there are length fields that aren't the exact length while unparsing but contain other factors:</p>


	<p>&lt;element name="len" type="xs:int" dfdl:outputValueCalc="{ fn:max(dfdl:valueLength(../ctElem, 'bytes'), 60) }" .../&gt;<br />...<br />&lt;element name="ctElem" dfdl:length="{ ../len }" .../&gt;</p>


	<p>In the above, we have a complex type element that has a minimum length of 60. So when unparsing if the actual length of the choice/sequence that is the model group of the ctElem is of length less than 60, we need to fill out the ElementUnused region of the DFDL grammar so as to achieve the min length of 60 bytes.</p>


	<p>If the dfdl:outputValueCalc of the len element was to call dfdl:contentLength, then we would have a circularity.</p>


	<p>Erratum 5.18 clarifies that length expressions are evaluated when unparsing to produce the target length that is used for pad/fill.</p>


	<p>This concept must be extended to complex types so that it also addresses the ElementUnused region that can follow the model group of a complex type.</p>


	<p>To clarify all this I suggest the DFDL data grammar must be changed as follows:</p>


	<p>ComplexNormalRep = LeftFraming PrefixLength ComplexContent RightFraming # Unchanged. Just here for context<br />ComplexContent = ComplexValue ElementUnused<br />ComplexValue = Sequence | Choice</p>


	<p>The above change basically moves ELementUnused out of the ComplexNormalRep production into a separate ComplexContent production, and distinguishes ComplexValue from ComplexContent.</p>


	<p>With the above grammar rule changes, I believe the spec as modified for Erratum 5.18 will be correct. (Everyplace where lengthKind explicit is lumped in with prefixed etc must be broken out, as it is a different case. )</p>


	<p>2) Spec says escapeCharacter, escapeBlockStart, and excapeBlockEnd contribute to the content length of an element. (Note: escapeEscapeCharacter is missing this stipulation and should be made consistent.)</p>


	<p>However, I believe this is incorrect. These all contribute to the <strong>value</strong> length, that is to say, they appear within the "SimpleValue | NilLogicalValue" region of the grammar.</p>


	<p>3) Definition of dfdl:valueLength must be changed to specify that it returns the length of the ComplexValue region for complex types, and excludes any filling of the ElementUnused region.</p>


	<p>The definition of dfdl:contentLength is acceptable as is.</p>
  </div>








<hr />
<div id="relations">
<div class="contextual">

</div>

<p><strong>Related issues</strong></p>


<form>
<table class="list issues">

<tr class="issue hascontextmenu" id="relation-2">
<td class="checkbox"><input name="ids[]" type="checkbox" value="196" /></td>
<td class="subject">related to 
    DFDL WG - 
    <a href="196.html" class="issue status-16 priority-2 closed">document #196</a>: dfdl:valueLength function - unclear what it does
</td>
<td class="status">closed</td>
<td class="start_date">09/26/2013</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

</table>
</form>


<form action="https://redmine.ogf.org/issues/316/relations" id="new-relation-form" method="post" onsubmit="new Ajax.Request('/issues/316/relations', {asynchronous:true, evalScripts:true, method:'post', onComplete:function(request){Form.Element.focus('relation_issue_to_id');}, parameters:Form.serialize(this)}); return false;" style="display: none;"><div style="margin:0;padding:0;display:inline"><input name="authenticity_token" type="hidden" value="r8Eug2mxB/WVzjgYLFlaVTYqdY6Jf1KWLwk+E/4zIM4=" /></div>


<p><select id="relation_relation_type" name="relation[relation_type]" onchange="setPredecessorFieldsVisibility();"><option value="relates">related to</option>
<option value="duplicates">duplicates</option>
<option value="duplicated">duplicated by</option>
<option value="blocks">blocks</option>
<option value="blocked">blocked by</option>
<option value="precedes">precedes</option>
<option value="follows">follows</option></select>
Issue #<input id="relation_issue_to_id" name="relation[issue_to_id]" size="10" type="text" />
<div id="related_issue_candidates" class="autocomplete"></div>
<script type="text/javascript">
//<![CDATA[
observeRelatedIssueField('/issues/auto_complete?id=316&amp;project_id=dfdl-wg')
//]]>
</script>
<span id="predecessor_fields" style="display:none;">
Delay: <input id="relation_delay" name="relation[delay]" size="3" type="text" /> days
</span>
<input name="commit" type="submit" value="Add" />
<a href="#" onclick="Element.toggle('new-relation-form'); this.blur(); return false;">Cancel</a>
</p>

<script type="text/javascript">
//<![CDATA[
setPredecessorFieldsVisibility();
//]]>
</script>

</form>

</div>


</div>




<div id="history">
<h3>History</h3>

  <div id="change-1208" class="journal has-details">
    <h4><div class="journal-link"><a href="316.html#note-1">#1</a></div>
    
    <a name="note-1"></a>
    Updated by <a href="../users/91.html">Michael Beckerle</a> <a href="https://redmine.ogf.org/projects/dfdl-wg/activity?from=2017-11-21" title="11/21/2017 10:56 AM">almost 5 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Target version</strong> set to <i>DFDL v1.0</i></li>
      
    </ul>
    
    
  </div>
  

  <div id="change-1321" class="journal has-notes has-details">
    <h4><div class="journal-link"><a href="316.html#note-2">#2</a></div>
    
    <a name="note-2"></a>
    Updated by <a href="../users/91.html">Michael Beckerle</a> <a href="https://redmine.ogf.org/projects/dfdl-wg/activity?from=2019-10-11" title="10/11/2019 02:41 PM">about 3 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>submitted</i> to <i>accepted</i></li>
      
    </ul>
    
    <div class="wiki" id="journal-1321-notes"><p>Erratum 5.44</p></div>
  </div>
  

  <div id="change-1405" class="journal has-details">
    <h4><div class="journal-link"><a href="316.html#note-3">#3</a></div>
    
    <a name="note-3"></a>
    Updated by <a href="../users/91.html">Michael Beckerle</a> <a href="https://redmine.ogf.org/projects/dfdl-wg/activity?from=2020-10-29" title="10/29/2020 01:28 PM">about 2 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>accepted</i> to <i>closed</i></li>
      
       <li><strong>% Done</strong> changed from <i>0</i> to <i>100</i></li>
      
    </ul>
    
    
  </div>
  




</div>



<div style="clear: both;"></div>
<div class="contextual">


<span class="issue-316-watcher"></span>




</div>


<div style="clear: both;"></div>


<p class="other-formats">(Other formats not available in this archive.</p>






<div id="context-menu" style="display: none;"></div>
<script type="text/javascript">
//<![CDATA[
new ContextMenu('/issues/context_menu')
//]]>
</script>

        
        <div style="clear:both;"></div>
    </div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="http://www.redmine.org/">Redmine</a> &copy; 2006-2012 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>

This is a static archive of the previous Open Grid Forum Redmine content management system saved from host redmine.ogf.org file /issues/316 at Thu, 03 Nov 2022 01:52:47 GMT
</html>
